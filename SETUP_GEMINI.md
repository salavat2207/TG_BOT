# Настройка бесплатного Google Gemini API

## Gemini API - полностью бесплатный для базового использования!

Google Gemini предоставляет бесплатный tier с щедрыми лимитами:
- **60 запросов в минуту**
- **1,500 запросов в день**
- Доступ к мощным моделям Gemini Pro и Gemini Flash

## Пошаговая инструкция

### Шаг 1: Регистрация на Google AI Studio

1. Перейдите на https://aistudio.google.com/app/apikey
2. Войдите через ваш Google аккаунт
3. Если у вас нет аккаунта, создайте его на https://accounts.google.com/

### Шаг 2: Создание API ключа

1. После входа в Google AI Studio нажмите **"Create API Key"**
2. Выберите проект Google Cloud (или создайте новый)
3. Скопируйте созданный ключ (он начинается с `AIza...`)
   - ⚠️ **Важно:** Ключ можно скопировать сразу после создания

### Шаг 3: Настройка в проекте

1. Откройте файл `.env` в корне проекта
2. Добавьте или обновите строку:
   ```env
   GEMINI_API_KEY=AIzaваш_ключ_здесь
   ```
3. Убедитесь, что ключ скопирован полностью без пробелов

### Шаг 4: Проверка работы

1. Перезапустите бота:
   ```bash
   ./run_local.sh
   ```
2. Отправьте боту вопрос в Telegram
3. Если все настроено правильно, бот ответит результатом из базы данных

## Важные моменты

### Приоритет API в коде:
- **Сначала используется Gemini** (если `GEMINI_API_KEY` установлен)
- **Затем OpenAI** (если Gemini не настроен, но есть `OPENAI_API_KEY`)

### Если хотите использовать только Gemini:
- Убедитесь, что в `.env` есть `GEMINI_API_KEY`
- Можно удалить или закомментировать `OPENAI_API_KEY` (не обязательно)

### Лимиты Gemini (бесплатный tier):
- 60 запросов/минуту
- 1,500 запросов/день
- Для большинства ботов этого более чем достаточно!

### Если превышен лимит:
- Бот автоматически покажет понятное сообщение об ошибке
- Подождите минуту и попробуйте снова
- Или перейдите на платный план Google Cloud (если нужно больше)

## Доступные модели Gemini (бесплатно):

1. **gemini-pro** - основная модель (лучшее качество)
2. **gemini-1.5-pro** - новая версия Pro
3. **gemini-1.5-flash** - быстрая модель

Бот автоматически переключается между моделями при ошибках.

## Полезные ссылки:

- **Google AI Studio:** https://aistudio.google.com/
- **API Keys:** https://aistudio.google.com/app/apikey
- **Документация моделей:** https://ai.google.dev/models
- **Документация API:** https://ai.google.dev/docs

## Решение проблем

### Ошибка: "Неверный API ключ"
- Проверьте, что ключ скопирован полностью
- Убедитесь, что нет пробелов в начале/конце
- Получите новый ключ, если старый не работает

### Ошибка: "403 Forbidden"
- Проверьте правильность API ключа
- Убедитесь, что аккаунт не заблокирован
- Проверьте лимиты на https://aistudio.google.com/

### Ошибка: "Модель недоступна"
- Бот автоматически переключится на другую модель
- Проверьте доступные модели: https://ai.google.dev/models

### Ошибка: "Quota exceeded"
- Превышен дневной лимит (1,500 запросов)
- Подождите до следующего дня или перейдите на платный план
